"use strict";var v=Object.create;var p=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var C=Object.getPrototypeOf,E=Object.prototype.hasOwnProperty;var S=(t,i)=>{for(var s in i)p(t,s,{get:i[s],enumerable:!0})},N=(t,i,s,c)=>{if(i&&typeof i=="object"||typeof i=="function")for(let r of y(i))!E.call(t,r)&&r!==s&&p(t,r,{get:()=>i[r],enumerable:!(c=_(i,r))||c.enumerable});return t};var j=(t,i,s)=>(s=t!=null?v(C(t)):{},N(i||!t||!t.__esModule?p(s,"default",{value:t,enumerable:!0}):s,t)),A=t=>N(p({},"__esModule",{value:!0}),t);var H={};S(H,{webUpdateNotice:()=>h});module.exports=A(H);var m=require("fs"),$=require("path"),e=require("@plugin-web-update-notification/core");async function I(){return await import("vite").then(({version:t})=>t)}function F(t,i,s,{cssFileHash:c,jsFileHash:r}){let{customNotificationHTML:g,hiddenDefaultNotification:n,injectFileBase:l=""}=s,f=`<script>window.pluginWebUpdateNotice_version = '${i}';</script>`,d=g||n?"":`<link rel="stylesheet" href="${l}${e.DIRECTORY_NAME}/${e.INJECT_STYLE_FILE_NAME}.${c}.css">`,o=t;return o=o.replace("<head>",`<head>
    ${d}
    <script src="${l}${e.DIRECTORY_NAME}/${e.INJECT_SCRIPT_FILE_NAME}.${r}.js"></script>
    ${f}`),n||(o=o.replace("</body>",`<div class="${e.NOTIFICATION_ANCHOR_CLASS_NAME}"></div></body>`)),o}function h(t={}){let i,s,{versionType:c,customVersion:r,silence:g}=t,n="";c==="custom"?n=(0,e.getVersion)(c,r):n=(0,e.getVersion)(c);let l="",f="",d=(0,m.readFileSync)(`${(0,$.resolve)((0,e.get__Dirname)(),e.INJECT_STYLE_FILE_NAME)}.css`,"utf8").toString();f=(0,e.getFileHash)(d);let o="";return{name:"vue-vite-web-update-notice",apply:"build",enforce:"post",async configResolved(a){i=a,t.injectFileBase===void 0&&(t.injectFileBase=i.base),o=(0,e.generateJsFileContent)((0,m.readFileSync)(`${(0,$.resolve)((0,e.get__Dirname)(),e.INJECT_SCRIPT_FILE_NAME)}.js`,"utf8").toString(),n,t),l=(0,e.getFileHash)(o),s=await I()},generateBundle(a,u={}){n&&(u[e.JSON_FILE_NAME]={isAsset:!0,type:"asset",name:void 0,source:(0,e.generateJSONFileContent)(n,g),fileName:`${e.DIRECTORY_NAME}/${e.JSON_FILE_NAME}.json`},u[e.INJECT_STYLE_FILE_NAME]={isAsset:!0,type:"asset",name:void 0,source:d,fileName:`${e.DIRECTORY_NAME}/${e.INJECT_STYLE_FILE_NAME}.${f}.css`},u[e.INJECT_SCRIPT_FILE_NAME]={isAsset:!0,type:"asset",name:void 0,source:o,fileName:`${e.DIRECTORY_NAME}/${e.INJECT_SCRIPT_FILE_NAME}.${l}.js`})},transformIndexHtml:s===void 0?{enforce:"post",async transform(a){return n?F(a,n,t,{jsFileHash:l,cssFileHash:f}):a}}:{order:"post",handler(a,{chunk:u}){return n&&u?F(a,n,t,{jsFileHash:l,cssFileHash:f}):a}}}}0&&(module.exports={webUpdateNotice});
//# sourceMappingURL=index.cjs.map